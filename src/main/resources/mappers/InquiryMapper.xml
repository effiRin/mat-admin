<?xml version="1.0" encoding="UTF-8" ?>
        <!DOCTYPE mapper
                PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
                "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.matjo.pickafood.admin.inquiry.mapper.InquiryMapper">

    <!-- 검색 조건 -->
    <sql id ="search">
        <if test='type == "n"'>
            and answerFlag=0
        </if>
        <if test="keyword != null">
            and
            <foreach collection="types" item="item" separator="or" open="(" close=")">
                <if test='item == "t"'>
                    title like concat('%', #{keyword}, '%')
                </if>

                <if test='item == "c"'>
                    content like concat('%', #{keyword}, '%')
                </if>
                <if test='
                    item == "w"'>
                    writer like concat('%', #{keyword}, '%')
                </if>
            </foreach>
        </if>
    </sql>


    <select id="selectList" resultType="com.matjo.pickafood.admin.inquiry.domain.InquiryVO">
        select *
        from inquiry where delFlag=0
            <include refid="search"></include>
        order by answerFlag asc, inquiry_seq desc
        limit #{skip},#{size}
    </select>

    <select id="getTotal" resultType="int">
        select count(inquiry_seq)
            from inquiry where delFlag=0
            <include refid="search"></include>
    </select>

    <select id="selectOne" resultType="com.matjo.pickafood.admin.inquiry.domain.InquiryVO">
        select * from inquiry where inquiry_seq = #{inquiry_seq}
    </select>

    <update id="answerContent">
        update inquiry
        set answerContent = #{answerContent} ,answerDate = now(), answerFlag = 1, answerId='yiseul'
        where inquiry_seq = #{inquiry_seq}
    </update>

</mapper>